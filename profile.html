<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>INFINITY Empire ‚Äî –ü—Ä–æ—Ñ–∏–ª—å</title>
  <style>
    :root { --accent: #00e0c6; }
    html, body {
      margin: 0;
      height: 100%;
      font-family: 'Inter', sans-serif;
      background: linear-gradient(180deg, #20C6B8 0%, #1A2C5B 100%);
      color: #fff;
      overflow: hidden;
    }

    body.blur-active .page-content { filter: blur(8px); pointer-events: none; }

    .top-info {
      position: fixed;
      top: 16px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 18px;
      z-index: 1000;
    }
    .info-box {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 14px 28px;
      font-size: 22px;
      font-weight: 600;
      box-shadow: 0 0 10px rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.2);
    }

    .profile-container {
      display: flex;
      justify-content: space-between;
      padding: 120px 20px 100px;
      height: calc(100% - 180px);
      gap: 20px;
      box-sizing: border-box;
    }

    .stats, .profile {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.2);
      box-shadow: 0 0 10px rgba(0,0,0,0.25);
      padding: 20px;
    }

    .stats { width: 70%; display: flex; flex-direction: column; }
    .stats h2 { margin: 0 0 10px; }
    .stats p { font-size: 18px; margin: 6px 0; color: rgba(255,255,255,0.9); }

    .profile { width: 30%; text-align: center; position: relative; }
    .profile img.avatar {
      width: 110px; height: 110px; border-radius: 50%;
      border: 3px solid var(--accent);
      object-fit: cover; margin-bottom: 10px;
    }

    .edit-icon { position: absolute; top: 10px; right: 10px; width: 28px; cursor: pointer; }

    .ownership { display: flex; justify-content: center; gap: 20px; margin-top: 10px; }
    .ownership img { width: 50px; height: 50px; opacity: 0.9; cursor:pointer; transition:.2s; }
    .ownership img:hover { transform: scale(1.1); opacity:1; }

    .bottom-nav {
      position: fixed; bottom: 0; width: 100%; height: 70px;
      background: rgba(255,255,255,0.15); backdrop-filter: blur(10px);
      display: flex; justify-content: space-around; align-items: center;
      z-index: 1000;
    }

    .nav-item { display:flex; flex-direction:column; align-items:center; font-size:12px; text-decoration:none; color:#fff; }
    .nav-item img { width:28px; height:28px; margin-bottom:4px; }
    .nav-item.active span { color: var(--accent); }

    .modal { position:fixed; inset:0; background:rgba(0,0,0,0.6); display:none; justify-content:center; align-items:center; z-index:2000; }
    .modal-content { background:rgba(255,255,255,0.15); backdrop-filter:blur(10px); padding:20px; border-radius:20px; text-align:center; max-width:350px; width:90%; }

    .avatar-choice { display:flex; justify-content:center; gap:10px; margin:15px 0; }
    .avatar-choice img { width:60px; height:60px; border-radius:50%; border:2px solid transparent; cursor:pointer; transition:.2s; }
    .avatar-choice img.selected { border-color:var(--accent); transform:scale(1.1); }
  </style>
</head>
<body>

<div class="page-content">
  <div class="top-info">
    <div class="info-box" id="balanceBox">–ë–∞–ª–∞–Ω—Å: 0 ‚ÇΩ</div>
  </div>

  <div class="profile-container">
    <div class="stats" id="stats">
      <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
      <p id="clicksCount"></p>
      <p id="clickIncome"></p>
      <p id="businessCount"></p>
      <p id="propertyCount"></p>
      <p id="vehicleCount"></p>
      <p id="businessIncome"></p>
      <p id="rentIncome"></p>
      <p id="funIncome"></p>
      <p id="totalEarned"></p>
    </div>

    <div class="profile">
      <img src="assets/edit.png" class="edit-icon" id="editProfile">
      <img id="avatarDisplay" class="avatar" src="assets/avatar1.png">
      <h2 id="playerName"></h2>

      <div class="ownership">
        <img src="assets/car.png" id="openGarage">
        <img src="assets/plane.png">
        <img src="assets/house.png">
      </div>
    </div>
  </div>

  <div class="bottom-nav">
    <a href="fun.html" class="nav-item"><img src="assets/fun.png"><span>–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</span></a>
    <a href="business.html" class="nav-item"><img src="assets/business.png"><span>–ë–∏–∑–Ω–µ—Å—ã</span></a>
    <a href="index.html" class="nav-item"><img src="assets/earn.png"><span>–ó–∞—Ä–∞–±–æ—Ç–æ–∫</span></a>
    <a href="profile.html" class="nav-item active"><img src="assets/profile.png"><span>–ü—Ä–æ—Ñ–∏–ª—å</span></a>
    <a href="settings.html" class="nav-item"><img src="assets/settings.png"><span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></a>
  </div>
</div>

<!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
<div class="modal" id="registrationModal">
  <div class="modal-content">
    <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–∫–∞</h3>
    <input type="text" id="usernameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
    <div class="avatar-choice">
      <img src="assets/avatar1.png" data-avatar="assets/avatar1.png">
      <img src="assets/avatar2.png" data-avatar="assets/avatar2.png">
      <img src="assets/avatar3.png" data-avatar="assets/avatar3.png">
      <img src="assets/avatar4.png" data-avatar="assets/avatar4.png">
    </div>
    <button id="confirmRegistration">OK</button>
  </div>
</div>

<script>
const rates={"‚ÇΩ":1,"‚Ç∏":6.5,"$":0.012,"‚Ç¨":0.011};
function readRub(k){return parseFloat(localStorage.getItem(k+'_rub'))||0;}
function fmt(n){return Number(n).toLocaleString('ru-RU',{minimumFractionDigits:2,maximumFractionDigits:2});}
const currency=localStorage.getItem('currency')||'‚ÇΩ';

function updateBalance(){
  document.getElementById('balanceBox').textContent=`–ë–∞–ª–∞–Ω—Å: ${fmt(readRub('balance')*rates[currency])} ${currency}`;
}

function updateStats(){
  const garage = JSON.parse(localStorage.getItem("garage") || "[]");
  document.getElementById('vehicleCount').textContent=`–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤: ${garage.length}`;
  
  document.getElementById('clicksCount').textContent=`–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤: ${localStorage.getItem('totalClicks')||0}`;
  document.getElementById('clickIncome').textContent=`–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–ª–∏–∫–∞–º–∏: ${fmt(readRub('totalClickIncome'))} ‚ÇΩ`;
  document.getElementById('businessCount').textContent=`–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–∑–Ω–µ—Å–æ–≤: ${localStorage.getItem('businessCount')||0}`;
  document.getElementById('propertyCount').textContent=`–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏: ${localStorage.getItem('propertyCount')||0}`;
  document.getElementById('businessIncome').textContent=`–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ –±–∏–∑–Ω–µ—Å–µ: ${fmt(readRub('businessIncome'))} ‚ÇΩ`;
  document.getElementById('rentIncome').textContent=`–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –Ω–∞ –∞—Ä–µ–Ω–¥–µ: ${fmt(readRub('rentIncome'))} ‚ÇΩ`;
  document.getElementById('funIncome').textContent=`–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –Ω–∞ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è—Ö: ${fmt(readRub('funIncome'))} ‚ÇΩ`;
  document.getElementById('totalEarned').textContent=`–û–±—â–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫: ${fmt(readRub('totalEarned'))} ‚ÇΩ`;
}

updateBalance(); updateStats();
setInterval(()=>{updateBalance();updateStats();},800);

/* –ü–µ—Ä–µ—Ö–æ–¥ –≤ –≥–∞—Ä–∞–∂ */
document.getElementById("openGarage").addEventListener("click",()=>{
  location.href="garage.html";
});

/* –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è */
const modal=document.getElementById('registrationModal');
const nameInput=document.getElementById('usernameInput');
const confirmBtn=document.getElementById('confirmRegistration');
const avatars=document.querySelectorAll('.avatar-choice img');
let selectedAvatar='assets/avatar1.png';

avatars.forEach(a=>{
  a.addEventListener('click',()=>{
    avatars.forEach(x=>x.classList.remove('selected'));
    a.classList.add('selected');
    selectedAvatar=a.dataset.avatar;
  });
});

function openModal(){ modal.style.display='flex'; document.body.classList.add('blur-active'); }
function closeModal(){ modal.style.display='none'; document.body.classList.remove('blur-active'); }

if(!localStorage.getItem('username')){ openModal(); }
else{
  document.getElementById('playerName').textContent=localStorage.getItem('username');
  document.getElementById('avatarDisplay').src=localStorage.getItem('avatar')||'assets/avatar1.png';
}

confirmBtn.addEventListener('click',()=>{
  const name=nameInput.value.trim()||'–ò–≥—Ä–æ–∫';
  localStorage.setItem('username',name);
  localStorage.setItem('avatar',selectedAvatar);
  document.getElementById('playerName').textContent=name;
  document.getElementById('avatarDisplay').src=selectedAvatar;
  closeModal();
});
</script>

</body>
</html>
